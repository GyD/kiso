!function(){function DOMTokenList(el){for(var classes=(this.el=el).className.replace(/^\s+|\s+$/g,"").split(/\s+/),i=0;i<classes.length;i++)push.call(this,classes[i])}if(!(void 0===window.Element||"classList"in document.documentElement)){var obj,prop,getter,prototype=Array.prototype,push=prototype.push,splice=prototype.splice,join=prototype.join;DOMTokenList.prototype={add:function(token){this.contains(token)||(push.call(this,token),this.el.className=this.toString())},contains:function(token){return-1!=this.el.className.indexOf(token)},item:function(index){return this[index]||null},remove:function(token){if(this.contains(token)){for(var i=0;i<this.length&&this[i]!=token;i++);splice.call(this,i,1),this.el.className=this.toString()}},toString:function(){return join.call(this," ")},toggle:function(token){return this.contains(token)?this.remove(token):this.add(token),this.contains(token)}},window.DOMTokenList=DOMTokenList,obj=Element.prototype,prop="classList",getter=function(){return new DOMTokenList(this)},Object.defineProperty?Object.defineProperty(obj,prop,{get:getter}):obj.__defineGetter__(prop,getter)}}(),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(s){var el=this;if(!document.documentElement.contains(el))return null;do{if(el.matches(s))return el;el=el.parentElement||el.parentNode}while(null!==el&&1==el.nodeType);return null}),function(Drupal,drupalSettings,window,document,undefined){"use strict";var Tooltip=function(domNode){this.domNode=domNode,this.delay=drupalSettings.kiso.tooltip.delay,this.trigger=!1,this.globalEscapeBound,this.timeout,this.keyCode=Object.freeze({ESC:27})};Tooltip.prototype.init=function(){var parentMatchSelector='a[href]:not([tabindex="-1"]),textarea:not([disabled]):not([tabindex="-1"]),button:not([disabled]):not([tabindex="-1"]),[tabindex]:not([tabindex="-1"]),[contentEditable=true]:not([tabindex="-1"])';this.domNode.getAttribute("data-pattern")?(this.domNode.setAttribute("data-content",this.domNode.getAttribute("title")),this.domNode.removeAttribute("title"),this.trigger=this.domNode):this.domNode.closest(parentMatchSelector)?this.trigger=this.domNode.closest(parentMatchSelector):this.trigger=this.domNode,this.trigger&&(this.trigger.addEventListener("focus",this.show.bind(this)),this.trigger.addEventListener("blur",this.hide.bind(this))),this.domNode.addEventListener("mouseenter",this.show.bind(this)),this.domNode.addEventListener("mouseleave",this.hide.bind(this)),this.globalEscapeBound=this.globalEscape.bind(this),drupalSettings.kiso.tooltip.customDelay.length&&(this.delay=drupalSettings.kiso.tooltip.customDelay)},Tooltip.prototype.show=function(event){this.timeout=setTimeout(this.invokeTooltip.bind(this),this.delay)},Tooltip.prototype.hide=function(event){clearTimeout(this.timeout),this.dismissTooltip()},Tooltip.prototype.invokeTooltip=function(){this.trigger&&(this.trigger.classList.add("js-tooltip-visible"),document.addEventListener("keyup",this.globalEscapeBound))},Tooltip.prototype.dismissTooltip=function(){this.trigger&&(this.trigger.classList.remove("js-tooltip-visible"),document.removeEventListener("keyup",this.globalEscapeBound))},Tooltip.prototype.globalEscape=function(event){switch(console.log("[keyup] - event.keyCode:",event.keyCode),event.keyCode){case this.keyCode.ESC:clearTimeout(this.timeout),this.dismissTooltip(),event.stopPropagation(),event.preventDefault()}},Drupal.behaviors.tooltip={attach:function(context,drupalSettings){window.addEventListener("load",function(event){for(var tooltips=document.querySelectorAll("[role=img][aria-label], [data-pattern=tooltip][title]"),i=0;i<tooltips.length;i++){new Tooltip(tooltips[i]).init()}},!1)}}}(Drupal,drupalSettings,this,this.document);